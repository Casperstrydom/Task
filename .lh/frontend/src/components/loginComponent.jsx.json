{
    "sourceFile": "frontend/src/components/loginComponent.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1757419363279,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1757419446588,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,6 @@\n import React from \"react\";\r\n \r\n-export default function loginComponent() {\r\n+function LoginComponent() {\r\n   return <div>loginComponent</div>;\r\n }\r\n+export default LoginComponent;\r\n"
                },
                {
                    "date": 1757625583586,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,112 @@\n-import React from \"react\";\r\n+import { useState } from \"react\";\r\n+import \"../main/index.css\";\r\n \r\n-function LoginComponent() {\r\n-  return <div>loginComponent</div>;\r\n-}\r\n-export default LoginComponent;\r\n+const Login = ({ onLogin, switchToRegister }) => {\r\n+  const [formData, setFormData] = useState({\r\n+    email: \"\",\r\n+    password: \"\",\r\n+  });\r\n+\r\n+  const handleChange = (e) => {\r\n+    const { name, value } = e.target;\r\n+    setFormData((prev) => ({ ...prev, [name]: value }));\r\n+  };\r\n+\r\n+  const handleSubmit = (e) => {\r\n+    e.preventDefault();\r\n+    onLogin(formData);\r\n+  };\r\n+\r\n+  return (\r\n+    <div className=\"futuristic-auth-container\">\r\n+      {/* Animated background elements */}\r\n+      <div className=\"cyber-grid\"></div>\r\n+      <div className=\"glowing-orbs\">\r\n+        <div className=\"orb orb-1\"></div>\r\n+        <div className=\"orb orb-2\"></div>\r\n+        <div className=\"orb orb-3\"></div>\r\n+      </div>\r\n+\r\n+      <div className=\"auth-wrapper\">\r\n+        <div className=\"auth-card\">\r\n+          <div className=\"auth-header\">\r\n+            <h1 className=\"cyber-title\">\r\n+              <span className=\"cyber-title-text\">NEXUS ACCESS</span>\r\n+              <span className=\"cyber-title-cursor pulse\">_</span>\r\n+            </h1>\r\n+            <p className=\"auth-subtitle\">SECURE SYSTEM ENTRY POINT</p>\r\n+          </div>\r\n+\r\n+          <form className=\"cyber-form\" onSubmit={handleSubmit}>\r\n+            <div className=\"form-header\">\r\n+              <h2 className=\"neon-text\">USER LOGIN</h2>\r\n+              <div className=\"form-indicator\"></div>\r\n+            </div>\r\n+\r\n+            <div className=\"input-group\">\r\n+              <label className=\"input-label\">IDENTITY</label>\r\n+              <input\r\n+                type=\"email\"\r\n+                name=\"email\"\r\n+                value={formData.email}\r\n+                onChange={handleChange}\r\n+                className=\"cyber-input\"\r\n+                placeholder=\"ENTER YOUR EMAIL\"\r\n+                required\r\n+              />\r\n+            </div>\r\n+\r\n+            <div className=\"input-group\">\r\n+              <label className=\"input-label\">PASSPHRASE</label>\r\n+              <input\r\n+                type=\"password\"\r\n+                name=\"password\"\r\n+                value={formData.password}\r\n+                onChange={handleChange}\r\n+                className=\"cyber-input\"\r\n+                placeholder=\"ENTER YOUR PASSWORD\"\r\n+                required\r\n+              />\r\n+            </div>\r\n+\r\n+            <div className=\"form-options\">\r\n+              <label className=\"cyber-checkbox-container\">\r\n+                <input type=\"checkbox\" />\r\n+                <span className=\"checkmark\"></span>\r\n+                REMEMBER ME\r\n+              </label>\r\n+              <a href=\"#\" className=\"cyber-link\">\r\n+                FORGOT PASSPHRASE?\r\n+              </a>\r\n+            </div>\r\n+\r\n+            <button\r\n+              type=\"submit\"\r\n+              className=\"cyber-button cyber-button-primary full-width\"\r\n+            >\r\n+              <span className=\"cyber-button-glitch\">⟳</span>\r\n+              <span className=\"cyber-button-text\">ACCESS SYSTEM</span>\r\n+            </button>\r\n+\r\n+            <div className=\"auth-switch\">\r\n+              <span>NEW USER?</span>\r\n+              <button\r\n+                type=\"button\"\r\n+                onClick={switchToRegister}\r\n+                className=\"cyber-link\"\r\n+              >\r\n+                REQUEST ACCESS\r\n+              </button>\r\n+            </div>\r\n+          </form>\r\n+\r\n+          <div className=\"auth-footer\">\r\n+            <p>NEXUS SECURITY SYSTEM v2.4.7</p>\r\n+          </div>\r\n+        </div>\r\n+      </div>\r\n+    </div>\r\n+  );\r\n+};\r\n+\r\n+export default Login;\r\n"
                },
                {
                    "date": 1757925047301,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,26 +1,69 @@\n-import { useState } from \"react\";\r\n+import { useState, useEffect } from \"react\";\r\n import \"../main/index.css\";\r\n \r\n-const Login = ({ onLogin, switchToRegister }) => {\r\n-  const [formData, setFormData] = useState({\r\n-    email: \"\",\r\n-    password: \"\",\r\n-  });\r\n+const Login = ({ onLogin, switchToRegister, apiBase }) => {\r\n+  const [formData, setFormData] = useState({ email: \"\", password: \"\" });\r\n \r\n+  // Ask permission for notifications on login page load\r\n+  useEffect(() => {\r\n+    if (\"Notification\" in window && Notification.permission !== \"granted\") {\r\n+      Notification.requestPermission().then((permission) => {\r\n+        console.log(\"Notification permission:\", permission);\r\n+      });\r\n+    }\r\n+  }, []);\r\n+\r\n   const handleChange = (e) => {\r\n     const { name, value } = e.target;\r\n     setFormData((prev) => ({ ...prev, [name]: value }));\r\n   };\r\n \r\n-  const handleSubmit = (e) => {\r\n+  const handleSubmit = async (e) => {\r\n     e.preventDefault();\r\n     onLogin(formData);\r\n+\r\n+    // Register service worker and subscribe for push notifications\r\n+    if (\"serviceWorker\" in navigator && \"PushManager\" in window) {\r\n+      try {\r\n+        const registration = await navigator.serviceWorker.register(\"/sw.js\");\r\n+\r\n+        let subscription = await registration.pushManager.getSubscription();\r\n+        if (!subscription) {\r\n+          // Fetch VAPID public key from backend\r\n+          const res = await fetch(`${apiBase}/vapidPublicKey`);\r\n+          const vapidPublicKey = await res.text();\r\n+          const convertedKey = urlBase64ToUint8Array(vapidPublicKey);\r\n+\r\n+          subscription = await registration.pushManager.subscribe({\r\n+            userVisibleOnly: true,\r\n+            applicationServerKey: convertedKey,\r\n+          });\r\n+        }\r\n+\r\n+        // Send subscription to backend\r\n+        await fetch(`${apiBase}/subscribe`, {\r\n+          method: \"POST\",\r\n+          headers: { \"Content-Type\": \"application/json\" },\r\n+          body: JSON.stringify(subscription),\r\n+        });\r\n+\r\n+        console.log(\"Push subscription successful\");\r\n+      } catch (err) {\r\n+        console.error(\"Push subscription failed:\", err);\r\n+      }\r\n+    }\r\n   };\r\n \r\n+  function urlBase64ToUint8Array(base64String) {\r\n+    const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\r\n+    const base64 = (base64String + padding).replace(/\\-/g, \"+\").replace(/_/g, \"/\");\r\n+    const rawData = atob(base64);\r\n+    return Uint8Array.from([...rawData].map((c) => c.charCodeAt(0)));\r\n+  }\r\n+\r\n   return (\r\n     <div className=\"futuristic-auth-container\">\r\n-      {/* Animated background elements */}\r\n       <div className=\"cyber-grid\"></div>\r\n       <div className=\"glowing-orbs\">\r\n         <div className=\"orb orb-1\"></div>\r\n         <div className=\"orb orb-2\"></div>\r\n@@ -74,28 +117,19 @@\n                 <input type=\"checkbox\" />\r\n                 <span className=\"checkmark\"></span>\r\n                 REMEMBER ME\r\n               </label>\r\n-              <a href=\"#\" className=\"cyber-link\">\r\n-                FORGOT PASSPHRASE?\r\n-              </a>\r\n+              <a href=\"#\" className=\"cyber-link\">FORGOT PASSPHRASE?</a>\r\n             </div>\r\n \r\n-            <button\r\n-              type=\"submit\"\r\n-              className=\"cyber-button cyber-button-primary full-width\"\r\n-            >\r\n+            <button type=\"submit\" className=\"cyber-button cyber-button-primary full-width\">\r\n               <span className=\"cyber-button-glitch\">⟳</span>\r\n               <span className=\"cyber-button-text\">ACCESS SYSTEM</span>\r\n             </button>\r\n \r\n             <div className=\"auth-switch\">\r\n               <span>NEW USER?</span>\r\n-              <button\r\n-                type=\"button\"\r\n-                onClick={switchToRegister}\r\n-                className=\"cyber-link\"\r\n-              >\r\n+              <button type=\"button\" onClick={switchToRegister} className=\"cyber-link\">\r\n                 REQUEST ACCESS\r\n               </button>\r\n             </div>\r\n           </form>\r\n"
                },
                {
                    "date": 1757925091342,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,9 +56,9 @@\n \r\n   function urlBase64ToUint8Array(base64String) {\r\n     const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\r\n     const base64 = (base64String + padding)\r\n-      .replace(/\\-/g, \"+\")\r\n+      .replace(/-/g, \"+\")\r\n       .replace(/_/g, \"/\");\r\n     const rawData = atob(base64);\r\n     return Uint8Array.from([...rawData].map((c) => c.charCodeAt(0)));\r\n   }\r\n"
                },
                {
                    "date": 1757926205323,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import { useState, useEffect } from \"react\";\r\n import \"../main/index.css\";\r\n \r\n-const Login = ({ onLogin, switchToRegister, apiBase }) => {\r\n+const Login = ({ onLogin, switchToRegister }) => {\r\n   const [formData, setFormData] = useState({ email: \"\", password: \"\" });\r\n \r\n   // Ask permission for notifications on login page load\r\n   useEffect(() => {\r\n@@ -28,11 +28,10 @@\n         const registration = await navigator.serviceWorker.register(\"/sw.js\");\r\n \r\n         let subscription = await registration.pushManager.getSubscription();\r\n         if (!subscription) {\r\n-          // Fetch VAPID public key from backend\r\n-          const res = await fetch(`${apiBase}/vapidPublicKey`);\r\n-          const vapidPublicKey = await res.text();\r\n+          // Use VAPID public key from frontend .env\r\n+          const vapidPublicKey = import.meta.env.VITE_VAPID_PUBLIC_KEY;\r\n           const convertedKey = urlBase64ToUint8Array(vapidPublicKey);\r\n \r\n           subscription = await registration.pushManager.subscribe({\r\n             userVisibleOnly: true,\r\n@@ -40,8 +39,9 @@\n           });\r\n         }\r\n \r\n         // Send subscription to backend\r\n+        const apiBase = import.meta.env.VITE_API_BASE;\r\n         await fetch(`${apiBase}/subscribe`, {\r\n           method: \"POST\",\r\n           headers: { \"Content-Type\": \"application/json\" },\r\n           body: JSON.stringify(subscription),\r\n"
                }
            ],
            "date": 1757419363279,
            "name": "Commit-0",
            "content": "import React from \"react\";\r\n\r\nexport default function loginComponent() {\r\n  return <div>loginComponent</div>;\r\n}\r\n"
        }
    ]
}